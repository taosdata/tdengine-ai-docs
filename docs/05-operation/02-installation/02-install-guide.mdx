import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# 安装指南

## 先决条件

TDengine AI 的运行需要满足以下先决条件：
1. Python: 3.10-3.12 版本
1. Java: 21 及以上版本
1. glibc: 2.25 及以上版本

## 安装

请根据您的操作系统类型，选择合适的安装方式，安装 TDengine AI。以下是不同安装方式的详细步骤：

<Tabs>

<TabItem label="tar.gz 安装" value="tar">
1. 从[版本列表](../../release-history/version)页面下载获得最新的 `.tar.gz` 安装包
1. 执行以下命令，解压并安装，请将 `<version>` 替换为实际版本号
   ```bash
   tar zxvf tdengine-ai-enterprise-<version>-linux.tar.gz
   cd tdengine-ai-enterprise-<version>
   ./install.sh
   ```
1. TDengine AI 的默认安装路径为 `/usr/local/tdengine-ai`, 安装成功后，可以看到终端展示 "TDengine AI has been installed successfully!".
1. 可以通过以下命令查看更多安装选项
   ```bash
   ./install.sh -h
   ```
</TabItem>

<TabItem label="deb 安装" value="deb">
1. 从[版本列表](../../release-history/version)页面下载获得最新的 `.deb` 安装包
1. 执行以下命令，安装 deb 包，请将 `<version>` 替换为实际版本号
   ```bash
   dpkg -i tdengine-ai-enterprise-<version>-linux.deb
   ```
1. TDengine AI 的默认安装路径为 `/usr/local/tdengine-ai`, 安装成功后，可以看到终端展示 "TDengine AI has been installed successfully!".
</TabItem>

<TabItem label="rpm 安装" value="rpm">
1. 从[版本列表](../../release-history/version)页面下载获得最新的 `.rpm` 安装包
1. 执行以下命令，安装 rpm 包，请将 `<version>` 替换为实际版本号
   ```bash
   rpm -i tdengine-ai-enterprise-<version>-linux.rpm
   ```
1. TDengine AI 的默认安装路径为 `/usr/local/tdengine-ai`, 安装成功后，可以看到终端展示 "TDengine AI has been installed successfully!".
</TabItem>

<TabItem label="macOS 安装" value="macos">
1. 从 [版本列表](../../release-history/version) 页面下载获得最新的 macOS 安装包 (.pkg)
1. 双击安装包，按照提示完成安装
1. TDengine AI 的默认安装路径为 `/usr/local/tdengine-ai`
</TabItem>

<TabItem label="Windows 安装" value="windows">
1. 从 [版本列表](../../release-history/version) 页面下载获得最新的 Windows 安装包 (.exe)
2. 双击安装包，按照提示完成安装
3. 安装完成后，TDengine AI 的默认安装路径为 `C:\tdengine-ai`
</TabItem>

</Tabs>

## 启动

<Tabs>

<TabItem label="Linux 系统" value="linux">
安装完成后，您可以使用 `svc-tdengine-ai` 命令来启动 TDengine AI 的服务进程。
```bash
sudo svc-tdengine-ai start
```

您也可以用 `svc-tdengine-ai` 的其他命令来查看服务状态、停止服务等操作，例如：
```bash
sudo svc-tdengine-ai status # 查看服务状态
sudo svc-tdengine-ai stop   # 停止服务
```

您还可以直接使用 `systemctl` 命令，手动管理这些服务，以 `tdengine-ai` 服务为例：
```bash
sudo systemctl start tdengine-ai
sudo systemctl stop tdengine-ai
sudo systemctl status tdengine-ai
sudo systemctl restart tdengine-ai
```

:::info
- 执行 `systemctl` 和 `svc-tdengine-ai` 命令时，需要 _root_ 权限，对于非 _root_ 用户，请在命令前添加 `sudo`。
:::
</TabItem>

<TabItem label="macOS 系统" value="macos">
安装完成后，您可以使用 `svc-tdengine-ai` 命令来启动 TDengine AI 的服务进程。

```bash
sudo svc-tdengine-ai start
```

您也可以用 `svc-tdengine-ai` 的其他命令来查看服务状态、停止服务等操作：
```bash
sudo svc-tdengine-ai status
sudo svc-tdengine-ai stop
```

如果想手动管理这些服务，可以使用以下命令，以下示例使用 `tdengine-ai`:
```bash
sudo launchctl start com.taosdata.tdengine-ai
sudo launchctl stop com.taosdata.tdengine-ai
sudo launchctl list | grep tdengine-ai
sudo launchctl print system/com.taosdata.tdengine-ai
```

:::info
- `launchctl` 命令管理 `com.taosdata.tdengine-ai` 需要管理员权限，务必在前面加 `sudo` 来增强安全性。
- `sudo launchctl list | grep tdengine-ai` 指令返回的第一列是 `tdengine-ai` 启动的 java 程序的 PID, 若为 `-` 则说明 tdengine-ai 服务未运行。
- 如果服务异常，请查看系统日志 `launchd.log` 或者 `/usr/local/tdengine-ai/logs` 目录下的日志，获取更多信息。
:::
</TabItem>

<TabItem label="Windows 系统" value="windows">
安装后，可以在拥有管理员权限的 cmd 窗口执行 `sc` 命令，或在桌面双击 `TDengine AI` 图标来启动 TDengine AI 服务进程。
```bat
sc start tdengine-ai
```

如果想手动管理这些服务，可以在拥有管理员权限的 cmd 窗口执行 `sc` 命令，以 `tdengine-ai` 服务为例：
```bat
sc start tdengine-ai
sc stop tdengine-ai
sc query tdengine-ai
```
</TabItem>

</Tabs>

TDengine AI 正常启动后，包括以下三个服务：
- `tdengine-ai-h2`：用于存储 TDengine AI 的元数据和配置。
- `tdengine-ai-chat`：用于处理 AI 相关的任务和分析。
- `tdengine-ai`：核心服务，负责管理和提供数据访问。

## 卸载

1. 在 Linux/macOS 系统，可以通过如下命令卸载 TDengine AI 服务：
```bash
rmtdengine-ai -e yes
```
如果期望保留数据、日志和配置等，可以执行：
```bash
rmtdengine-ai -e no
```
2. 在 Linux 系统，如果是通过 rpm 方式安装，请使用如下命令卸载：
```bash
rpm -e tdengine-ai
```
3. 在 Linux 系统，如果是通过 deb 方式安装，请使用如下命令卸载：
```
dpkg -r tdengine-ai
```
4. 在 Windows 系统，可以在进入安装目录 `C:\tdengine-ai` 后，双击卸载程序 (unins000.exe) 进行卸载。
